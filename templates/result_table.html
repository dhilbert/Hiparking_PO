{% extends "layout.html" %}
{% block content %}

<h2>SQL ì‹¤í–‰ ê²°ê³¼</h2>

{% if error_msg %}
    <p style="color:red; font-weight:bold; margin-top:10px;">
        {{ error_msg }}
    </p>
{% endif %}

{% if rows and rows|length > 0 %}

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    {% for col in rows[0].keys() %}
                        <th>{{ col }}</th>
                    {% endfor %}
                </tr>
            </thead>

            <tbody>
                {% for row in rows %}
                <tr>
                    {% for val in row.values() %}
                        <td>{{ val }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ì—‘ì…€ ë‹¤ìš´ë¡œë“œ -->
    <form method="POST" action="/sql/download_excel">
        <input type="hidden" name="rows_json" value='{{ rows | tojson }}'>
        <button type="submit" class="btn-orange">ğŸ“¥ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
    </form>

{% else %}
    <p style="margin-top:20px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}
